<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>RNAfolding</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="title" content="RNAfolding"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2017-01-08T12:44-0500"/>
<meta name="author" content=""/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js">
/**
 *
 * @source: http://orgmode.org/mathjax/MathJax.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in http://orgmode.org/mathjax/MathJax.js.
 *
 * Copyright (C) 2012-2013  MathJax
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in http://orgmode.org/mathjax/MathJax.js.
 *
 */

/*
@licstart  The following is the entire license notice for the
JavaScript code below.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code below is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code below.
*/
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">RNAfolding</h1>


<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">How RNA folding is predicted</h2>
<div class="outline-text-2" id="text-1">


<p>
Many people might hear of fields such as RNA and protein folding and
wonder how that stuff must work. RNA is a physical system, therefore
it must obey the laws of physics. The most commonly used physical law
in the field of RNA prediction is the partition function law [TODO:
better name]. If RNA is modeled as a system in thermal equilibium then
the probability of any state \(s\) with energy \(E(s)\) is equal to 
$$P(s)= \frac{e^{-E(s)/kT}}{\sum_{s'} e^{-E(s')/kT}} $$
Therefore to predict the folding of RNA we need 3 things:
</p><ul>
<li>a specification of a state of RNA \(s\),
</li>
<li>an energy function, which takes a state and outputs a physical
  energy,
</li>
<li>the partition function, the sum of the Boltmann factors over every
  possible state \(Z = \sum_{s'} e^{-E(s)/kT}\).
</li>
</ul>


</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">States of RNA</h2>
<div class="outline-text-2" id="text-2">


<p>
RNA is polymer of 4 nucleic acids, adenine, guanine, cytosine, and
uracil. This "primary structure" of RNA can be specified with a simple
string of 4 letters, for example "GAAACCCCUUUUGGGG". For the secondary
structure of RNA, we are interested in which of these bases are going
to pair with each other. Any state of RNA can therefore be represented
as a list of base pairs \((i,j)\). For <b>tractability</b> reasons, in
practice the secondary structure of RNA is assumed to be composed of
several recursive types. 
</p>



<pre class="example">data Structure = (Paired 1 Int, Structure ) | Structure 
me :: Structure
me = Me
</pre>


<p>
This is actually a key assumption, because the computability of this
problem hinges on it. There is the question of whether it is a
physically valid assumption. The answer is unquivically NO. There are
many RNAs found in nature that have "crossing" pairs, which break the
recursive definition here, such as Group I and Group II introns [TODO:
cite someone]. However, without the recursive definition, computing
the partition function is intractable, so most RNA folding software
packages make this assumption.
</p>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">Energy Model</h2>
<div class="outline-text-2" id="text-3">

<p>For RNA, the most relevant energy to consider is electric
potential. Nucleic acids are covered in exposed ions, and each free
charge interacts with every other charge. The total energy can be
therefore expressed as a function of the charges and the distances
between them $U = f(\frac{q<sub>iq</sub><sub>j</sub>}{r<sub>ij</sub>}). 
</p>
<p>
This is far too complicated. For \(n\) charges there would be \(n^2\)
charges to consider. As we shall soon see, we want to be sure that the
energy model runs in constant time. How can we do this?
</p>
<p>
Doing a full physical energy model of RNA would be very difficult to
compute. In practice, there are several levels of complexity that are
implemented. A very simple energy model is one where each hydrogen
bond contributes exactly -1 unit of energy to the total. 
</p>
<p>
Reducing the complexity of the energy model to this allows us to
compute the energy recursively.
</p>



<pre class="example">typedef Joul = Real

energy :: Structure -&gt; Joule
data Structure = (Paired 1 Int, Structure ) | Structure 
me :: Structure
me = Me
</pre>



</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4">Partition Function</h2>
<div class="outline-text-2" id="text-4">

<p>The sum \(Z = \sum_{s'} e^{-E(s)/kT}\) initially seems daunting. There
are \(O(1.8^n)\) structures possible for an RNA strand of length
\(n\). However, from the recursive definition of our energy model, we
can easily see that the partition function can be defined recursively
as well:
</p>
<p>
[TODO: partition function definition]
</p>
<p>
This becomes a standard dynamic programming homework problem! We can
turn Z into a table of values where Z[i,j] is the partition function
from base \(i\) to base \(n\). Since each row of the table only depends on
the entries below and to the left, we can compute the full partition
function by starting from the bottom left and working out to the top
right. This is even parallelizable along the diagonals, as shown in
the diagram: 
</p>
<p>
[TODO: make elm diagram.]
</p>
<p>
Now that we have the partition function, we know the probability of
any structure from the Boltzmann distribution. 
</p>
</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5">Sampling RNA Structures</h2>
<div class="outline-text-2" id="text-5">


<p>
To actually predict the structure of RNA molecules in nature, we can
work backwards through the partition function table to sample
structures from the Boltzmann distribution with probability equal to
their probability to be found in nature. 
</p>
<p>
[Todo: Haskell code]
</p>
<p>
Let's try it out:
</p>
<p>
[Todo: try example]
</p>
<p>
Cool!
</p>
</div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6">Macrostates</h2>
<div class="outline-text-2" id="text-6">


<p>
One last thing to do is cluster these structures into
Macrostates. Given two structures of the same strand, a distance
measure can be computed between them and with this distance metric, we
can classify and compare macrostates. Let's sample a bunch of structures
</p>
</div>

</div>

<div id="outline-container-7" class="outline-2">
<h2 id="sec-7">Applications</h2>
<div class="outline-text-2" id="text-7">


<p>
Many genetic diseases are caused by mutations causing RNA to fold
incorrectly. The treatment is then to find some way to get it to fold
correctly again. One way to do this is to insert some binding agent to
block binding to a particular base or set of bases for that strand,
which disrupts the partition function, energy landscape, and causes
the strand to fold correctly. For example let's assume that the
healthy strand is [TODO: insert] but a pointwise mutation has caused
this to mutate to [TODO: insert]. We can compute a statistical
distance to the healthy boltzmann distribution and then pick a base to
block that gets us as close to the healthy distribution as possible. 
</p>
<p>
[TODO: do example]
</p>
<p>
Cool right?
</p></div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2017-01-08T12:44-0500</p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.3f with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 24</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
